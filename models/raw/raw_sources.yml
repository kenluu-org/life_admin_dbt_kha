version: 2

sources:
  - name: todoist_stateless_raw
    description: |
      - the stateless raw data that python script fetches
      - full refresh on every run.
    tables:
      - name: active_tasks
        description: Raw todoist tasks data from local JSON file
        config:
          external_location: EL/todoist/raw/active_tasks.jsonl
        columns: []
      - name: completed_tasks
        description: Raw todoist tasks data from local JSON file
        config:
          external_location: EL/todoist/raw/completed_tasks.jsonl
        columns: []
      - name: active_projects
        description: Raw todoist projects data from local JSON file
        config:
          external_location: EL/todoist/raw/active_projects.jsonl
        columns: []
      - name: archived_projects
        description: Raw todoist projects data from local JSON file
        config:
          external_location: EL/todoist/raw/archived_projects.jsonl
        columns: []

  - name: todoist_raw_dump
    description: |
      - source that leverages the dbt util https://github.com/dbt-labs/dbt-external-tables
      to load the local jsonl dumps into BQ.
      - should be run ad hoc. 
    tables:
      - name: active_tasks
        description: Raw todoist tasks data from local JSON file
        external:
          location: "{{'gs://' ~  env_var('GCS_RAW_BUCKET') ~ '/todoist/active_tasks.jsonl' }}"
          options:
            format: NEWLINE_DELIMITED_JSON
        columns: []
      - name: completed_tasks
        description: Raw todoist tasks data from local JSON file
        external:
          location: "{{'gs://' ~  env_var('GCS_RAW_BUCKET') ~ '/todoist/completed_tasks.jsonl' }}"
          options:
            format: NEWLINE_DELIMITED_JSON
        columns: []
      - name: active_projects
        description: Raw todoist projects data from local JSON file
        external:
          location: "{{'gs://' ~  env_var('GCS_RAW_BUCKET') ~ '/todoist/active_projects.jsonl' }}"
          options:
            format: NEWLINE_DELIMITED_JSON
        columns: []
      - name: archived_projects
        description: Raw todoist projects data from local JSON file
        external:
          location: "{{'gs://' ~  env_var('GCS_RAW_BUCKET') ~ '/todoist/archived_projects.jsonl' }}"
          options:
            format: NEWLINE_DELIMITED_JSON
        columns: []
